# 开发进度日志

> 记录每步开发的推进状态，便于复盘与接续开发。

---

## 第一步：工程初始化与基础配置

- **状态**：✅ 已完成
- **完成时间**：2026-02-16
- **Git Commit**：`71f7e2d`
- **交付物**：
  - NestJS 工程骨架（可编译、可运行）
  - 健康检查接口 `GET /health` → `{ status: "ok", timestamp: "..." }`
  - 全量依赖声明（NestJS、Drizzle、BetterAuth、Neon、Upstash、R2）
  - 配置文件：`tsconfig.json`、`tsconfig.build.json`、`nest-cli.json`
  - 安全基线：`.gitignore`（增强）、`.env.example`、`SECURITY.md`
  - 容器化：`Dockerfile`（Node 22 Alpine 多阶段构建）
- **验证记录**：

  **1. 依赖安装**
  ```bash
  npm install
  ```
  > ✅ added 486 packages

  **2. 编译验证**
  ```bash
  npm run build
  ```
  > ✅ 编译成功，无错误输出，产物输出至 `dist/`

  **3. 服务启动 + 健康检查**
  ```bash
  npm run start
  # 另开终端：
  curl http://localhost:3000/health
  ```
  ```json
  {"status":"ok","timestamp":"2026-02-16T12:00:00.000Z"}
  ```
  > ✅ HTTP 200

  **4. Docker 构建**
  ```bash
  docker build -t ai-coding-museum .
  ```
  > ✅ 多阶段构建成功（Node 22 Alpine），镜像加速源：`https://docker.xuanyuan.me`

  **5. Docker 容器运行 + 健康检查**
  ```bash
  docker run -d -p 3000:3000 --env-file .env ai-coding-museum
  curl http://localhost:3000/health
  ```
  ```json
  {"status":"ok","timestamp":"2026-02-16T12:05:00.000Z"}
  ```
  > ✅ 容器内服务正常响应

- **备注**：
  - Docker 镜像加速源通过 OrbStack Settings → Docker → Engine 配置
  - 时间戳为近似值，实际值随运行时变化
- **设计详情**：见《技术框架设计》文档 → 第一步

---

## 第二步：数据库接入与 Drizzle ORM 配置

- **状态**：✅ 已完成
- **完成时间**：2026-02-18
- **Git Commit**：`a988a20`
- **交付物**：
  - 数据库模块 `DatabaseModule`（全局，Drizzle + Neon HTTP 驱动）
  - Drizzle Provider（`@Inject(DRIZZLE)` 注入模式）
  - Schema 骨架（`src/database/schema/index.ts`）
  - Drizzle Kit 迁移配置（`drizzle.config.ts`）
  - 健康检查接口增加数据库连接状态 `database: "connected" | "disconnected"`
- **验证记录**：

  **1. 编译验证**
  ```bash
  npm run build
  ```
  > ✅ 编译成功，无错误输出

  **2. 健康检查（含数据库状态）**
  ```bash
  curl http://localhost:3000/health
  ```
  ```json
  {"status":"ok","database":"connected"}
  ```
  > ✅ HTTP 200，数据库连接正常（Neon PostgreSQL via HTTP driver）

- **设计详情**：见《技术框架设计》文档 → 第二步

---

## 第三步：用户认证系统（BetterAuth + Drizzle）

- **状态**：✅ 已完成
- **完成时间**：2026-02-18
- **Git Commit**：`6c07843`
- **交付物**：
  - 认证模块 `AuthModule`（AuthService + AuthController）
  - BetterAuth 集成（drizzleAdapter + emailAndPassword 策略）
  - 认证 Controller 桥接（`toNodeHandler` 转发 `/api/auth/*` 路由）
  - 数据库 Schema 定义（user、session、account、verification 4 张表）
  - 首次数据库迁移（`drizzle/0000_workable_stone_men.sql`）
  - `.env.example` 新增 `AUTH_SECRET` 和 `BETTER_AUTH_URL` 占位符
- **验证记录**：

  **1. 编译验证**
  ```bash
  npm run build
  ```
  > ✅ 编译成功，无错误输出

  **2. 数据库迁移**
  ```bash
  npx drizzle-kit generate
  npx drizzle-kit migrate
  ```
  > ✅ 生成迁移文件 `drizzle/0000_workable_stone_men.sql`
  >
  > ✅ 迁移执行成功，创建 4 张表：user、session、account、verification

  **3. 用户注册**
  ```bash
  curl -s -X POST http://localhost:3000/api/auth/sign-up/email \
    -H "Content-Type: application/json" \
    -d '{"name":"测试用户","email":"test@example.com","password":"Test123456"}'
  ```
  ```json
  {
    "token": "eyJhbGci...<JWT略>",
    "user": {
      "id": "<UUID>",
      "name": "测试用户",
      "email": "test@example.com",
      "emailVerified": false,
      "image": null,
      "createdAt": "2026-02-18T...",
      "updatedAt": "2026-02-18T..."
    }
  }
  ```
  > ✅ HTTP 200，注册成功，返回用户对象 + token

  **4. 用户登录**
  ```bash
  curl -s -X POST http://localhost:3000/api/auth/sign-in/email \
    -H "Content-Type: application/json" \
    -d '{"email":"test@example.com","password":"Test123456"}' \
    -c tmp/cookies.txt
  ```
  ```json
  {
    "token": "eyJhbGci...<JWT略>",
    "user": {
      "id": "<UUID>",
      "name": "测试用户",
      "email": "test@example.com",
      "emailVerified": false,
      "image": null,
      "createdAt": "2026-02-18T...",
      "updatedAt": "2026-02-18T..."
    }
  }
  ```
  > ✅ HTTP 200，登录成功
  >
  > 响应头包含 `Set-Cookie: better-auth.session_token=<token>.<HMAC签名>; HttpOnly; Path=/; Max-Age=604800; SameSite=Lax`
  >
  > Cookie 已通过 `-c tmp/cookies.txt` 自动保存到文件

  **5. 会话查询**
  ```bash
  curl -s http://localhost:3000/api/auth/get-session -b tmp/cookies.txt
  ```
  ```json
  {
    "session": {
      "id": "<UUID>",
      "userId": "<UUID>",
      "token": "<session_token>",
      "expiresAt": "2026-02-25T...",
      "createdAt": "2026-02-18T...",
      "updatedAt": "2026-02-18T...",
      "ipAddress": "::1",
      "userAgent": "curl/8.x"
    },
    "user": {
      "id": "<UUID>",
      "name": "测试用户",
      "email": "test@example.com",
      "emailVerified": false,
      "image": null,
      "createdAt": "2026-02-18T...",
      "updatedAt": "2026-02-18T..."
    }
  }
  ```
  > ✅ HTTP 200，会话有效，返回完整 session + user 对象

  **6. 健康检查**
  ```bash
  curl http://localhost:3000/health
  ```
  ```json
  {"status":"ok","database":"connected"}
  ```
  > ✅ 服务及数据库均正常

  **7. 测试数据清理**
  > 验证完成后，通过 Neon SQL Editor 手动清理测试数据：
  ```sql
  DELETE FROM session;
  DELETE FROM account;
  DELETE FROM "user" WHERE email = 'test@example.com';
  ```
  > ✅ 4 张表已恢复为空

- **备注**：
  - 返回值中 `<UUID>`、`<JWT略>`、`<token>` 等为脱敏占位，实际为 BetterAuth 自动生成的值
  - 原始测试数据已清理，上述响应体为当时结构的精确还原（字段名和层级完全一致，动态值如 ID/时间戳为代表性值）
- **设计详情**：见《技术框架设计》文档 → 第三步

---

## 第四步：核心业务骨架（内容发布 + 点赞 + 用户信息）

- **状态**：✅ 已完成
- **完成时间**：2026-02-23
- **Git Commit**：`c7a5867`
- **交付物**：
  - 全局 ExceptionFilter（`src/common/http-exception.filter.ts`），统一错误格式 `{ code, message }`
  - 会话鉴权 Guard `AuthGuard`（`src/auth/auth.guard.ts`）
  - posts 模块：POST/GET `/api/posts`、POST `/api/posts/:id/like`
  - users 模块：GET `/api/users/me`、GET `/api/users/:id`
  - 数据库 Schema：post、post_like 表
  - 迁移：`drizzle/0001_wild_mojo.sql`
- **验证记录**：

  **1. 编译验证**
  ```bash
  npm run build
  ```
  > ✅ 编译成功，无错误输出

  **2. 数据库迁移**
  ```bash
  npx drizzle-kit generate
  npx drizzle-kit migrate
  ```
  > ✅ 迁移执行成功，post、post_like 表已创建

  **3. 未登录发帖（预期 HTTP 401）**
  ```bash
  curl -s -X POST http://localhost:3000/api/posts \
    -H "Content-Type: application/json" \
    -d '{"content":"hello"}'
  ```
  ```json
  {"code":"UNAUTHORIZED","message":"未登录或会话已过期"}
  ```
  > ✅ HTTP 401，符合预期

  **4. 已登录发帖（需先登录保存 Cookie）**
  ```bash
  curl -s -X POST http://localhost:3000/api/auth/sign-in/email \
    -H "Content-Type: application/json" \
    -d '{"email":"test@example.com","password":"Test123456!"}' \
    -c tmp/cookies.txt

  curl -s -X POST http://localhost:3000/api/posts \
    -H "Content-Type: application/json" \
    -b tmp/cookies.txt \
    -d '{"content":"hello"}'
  ```
  ```json
  {
    "id": "<UUID>",
    "userId": "<USER_ID>",
    "content": "hello",
    "mediaUrls": null,
    "createdAt": "2026-02-23T...",
    "updatedAt": "2026-02-23T..."
  }
  ```
  > ✅ HTTP 201，返回 post 对象

  **5. 浏览时间流**
  ```bash
  curl -s "http://localhost:3000/api/posts?limit=10" -b tmp/cookies.txt
  ```
  > ✅ HTTP 200，返回 post 数组（可能为空）

  **6. 点赞**
  ```bash
  curl -s -X POST http://localhost:3000/api/posts/<POST_ID>/like -b tmp/cookies.txt
  ```
  ```json
  {"liked":true}
  ```
  > ✅ HTTP 200，toggle 成功

  **7. 当前用户**
  ```bash
  curl -s http://localhost:3000/api/users/me -b tmp/cookies.txt
  ```
  > ✅ HTTP 200，返回 user（含 id,name,email,image）

  **8. 他人信息**
  ```bash
  curl -s http://localhost:3000/api/users/<USER_ID> -b tmp/cookies.txt
  ```
  > ✅ HTTP 200，返回脱敏 user（无 email）

- **设计详情**：见《技术框架设计》文档 → 第四步

- **回归验证**（2026-02-26，AI 自行执行）：
  - 结论：**通过**
  - 执行项：编译、未登录 401、注册、登录、发帖、时间流、点赞、当前用户、他人信息、content 空 400、点赞 toggle、post 不存在 404
  - 证据（节选）：未登录发帖 `{"code":"UNAUTHORIZED","message":"未登录或会话已过期"}` HTTP 401；发帖 HTTP 201 返回 post；他人信息无 email 字段；404 返回 `{"code":"NOT_FOUND","message":"帖子不存在"}`

---

## 第五步：对象存储（R2 Presigned URL）

- **状态**：✅ 已完成
- **完成时间**：2026-03-01
- **Git Commit**：`9e97daa`
- **交付物**：
  - StorageModule 和 StorageService（R2 客户端 + Presigned URL 生成）
  - StorageController（`GET /api/storage/upload-url`）
  - 发帖接口支持 mediaUrls 字段
- **验证记录**：

  **1. 编译验证**
  ```bash
  npm run build
  ```
  > ✅ 编译成功，无错误输出

  **2. 健康检查**
  ```bash
  curl http://localhost:3000/health
  ```
  ```json
  {"status":"ok","timestamp":"2026-02-28T16:31:47.789Z","database":"connected"}
  ```
  > ✅ HTTP 200

  **3. 登录获取 Cookie**
  ```bash
  curl -X POST http://localhost:3000/api/auth/sign-in/email \
    -H "Content-Type: application/json" \
    -d '{"email":"test@example.com","password":"Test123456!"}' \
    -c tmp/cookies.txt
  ```
  ```json
  {"redirect":false,"token":"9vzbObjoUL0sxqHD3A8HZr6LB7ZNOQMx","user":{...}}
  ```
  > ✅ HTTP 200，Cookie 已保存

  **4. 获取上传 URL**
  ```bash
  curl "http://localhost:3000/api/storage/upload-url?filename=test.jpg&contentType=image/jpeg" -b tmp/cookies.txt
  ```
  ```json
  {
    "uploadUrl": "https://xinglong.f216ba44831af313e54b2e854cebeece.r2.cloudflarestorage.com/uploads/<userId>/<uuid>.jpg?X-Amz-...",
    "objectKey": "uploads/<userId>/<uuid>.jpg",
    "publicUrl": "https://pub-be2afd8a125d477597f3ce0e9e5eb48a.r2.dev/uploads/<userId>/<uuid>.jpg"
  }
  ```
  > ✅ HTTP 200，预签名 URL 生成成功
  >
  > 注：`<userId>`、`<uuid>` 为占位符，实际值为运行时生成的用户 ID 和 UUID

  **5. 上传文件到 R2**
  ```bash
  curl -X PUT "<uploadUrl>" -H "Content-Type: image/jpeg" --data-binary @test.jpg
  ```
  > ✅ HTTP 200，上传成功
  >
  > 注：`<uploadUrl>` 为上一步返回的 uploadUrl 值

  **6. 发帖带媒体**
  ```bash
  curl -X POST http://localhost:3000/api/posts \
    -H "Content-Type: application/json" \
    -b tmp/cookies.txt \
    -d '{"content":"带图片的帖子","mediaUrls":["https://pub-xxx.r2.dev/uploads/<userId>/<uuid>.jpg"]}'
  ```
  ```json
  {
    "id": "10f47640-fe10-4d09-81bf-cfe710821527",
    "userId": "<userId>",
    "content": "带图片的帖子",
    "mediaUrls": ["https://pub-be2afd8a125d477597f3ce0e9e5eb48a.r2.dev/uploads/<userId>/<uuid>.jpg"],
    "createdAt": "2026-02-28T16:33:12.915Z",
    "updatedAt": "2026-02-28T16:33:12.915Z"
  }
  ```
  > ✅ HTTP 201，mediaUrls 正确保存
  >
  > 注：`<userId>`、`<uuid>` 为占位符，实际值如 `c8j2SNJ8eqeTQSSWidPuLu68ZURwGq2f`、`43bb7aa4-9c3a-4df4-b5a2-16cba21fc4aa`

  **7. 文件类型校验**
  ```bash
  curl "http://localhost:3000/api/storage/upload-url?filename=test.exe&contentType=application/octet-stream" -b tmp/cookies.txt
  ```
  ```json
  {"code":"BAD_REQUEST","message":"不支持的文件类型"}
  ```
  > ✅ HTTP 400，正确拦截不支持的文件类型

  **8. 未登录访问**
  ```bash
  curl "http://localhost:3000/api/storage/upload-url?filename=test.jpg&contentType=image/jpeg"
  ```
  ```json
  {"code":"UNAUTHORIZED","message":"未登录或会话已过期"}
  ```
  > ✅ HTTP 401，正确拦截未登录请求

  **9. 浏览时间流（含 mediaUrls）**
  ```bash
  curl "http://localhost:3000/api/posts?limit=10" -b tmp/cookies.txt
  ```
  ```json
  [
    {
      "id": "<uuid>",
      "content": "带图片的帖子",
      "mediaUrls": ["https://pub-be2afd8a125d477597f3ce0e9e5eb48a.r2.dev/uploads/<userId>/<uuid>.jpg"],
      ...
    }
  ]
  ```
  > ✅ HTTP 200，mediaUrls 正确返回

- **设计详情**：见《技术框架设计》文档 → 第五步

---

## 第六步：评论系统（楼中楼 + 点赞 + 删除）

- **状态**：✅ 已完成
- **完成时间**：2026-03-01
- **Git Commit**：`38e3287`
- **交付物**：
  - CommentsModule（CommentsService + CommentsController）
  - 评论发表、回复（最多5层嵌套）、点赞、删除功能
  - 数据库 Schema：comment、comment_like 表
  - 迁移：`drizzle/0002_cynical_night_thrasher.sql`
- **验证记录**：

  **1. 编译验证**
  ```bash
  npm run build
  ```
  > ✅ 编译成功，无错误输出

  **2. 数据库迁移**
  ```bash
  npx drizzle-kit generate
  npx drizzle-kit migrate
  ```
  > ✅ 迁移执行成功，comment、comment_like 表已创建

  **3. 发表顶级评论**
  ```bash
  curl -s -X POST "http://localhost:3000/api/posts/<POST_ID>/comments" \
    -H "Content-Type: application/json" \
    -b tmp/cookies.txt \
    -d '{"content":"这是第一条顶级评论"}'
  ```
  ```json
  {"id":"<UUID>","postId":"<POST_ID>","userId":"<USER_ID>","content":"这是第一条顶级评论","parentId":null,"depth":0,"likeCount":0,"createdAt":"2026-03-01T...","updatedAt":"2026-03-01T...","deletedAt":null}
  ```
  > ✅ HTTP 201，返回 comment 对象，depth=0

  **4. 发表回复（楼中楼）**
  ```bash
  curl -s -X POST "http://localhost:3000/api/posts/<POST_ID>/comments" \
    -H "Content-Type: application/json" \
    -b tmp/cookies.txt \
    -d '{"content":"回复第一条评论","parentId":"<COMMENT_ID>"}'
  ```
  ```json
  {"id":"<UUID>","postId":"<POST_ID>","userId":"<USER_ID>","content":"回复第一条评论","parentId":"<COMMENT_ID>","depth":1,...}
  ```
  > ✅ HTTP 201，depth=1，parentId 正确关联

  **5. 嵌套深度限制（超过5层）**
  ```bash
  # 创建 depth=4 的评论后，尝试回复
  curl -s -X POST "http://localhost:3000/api/posts/<POST_ID>/comments" \
    -H "Content-Type: application/json" \
    -b tmp/cookies.txt \
    -d '{"content":"depth=5 - 这应该失败","parentId":"<DEPTH_4_COMMENT_ID>"}'
  ```
  ```json
  {"code":"BAD_REQUEST","message":"评论嵌套深度不能超过 5 层"}
  ```
  > ✅ HTTP 400，正确拦截超过5层嵌套

  **6. 评论点赞**
  ```bash
  curl -s -X POST "http://localhost:3000/api/comments/<COMMENT_ID>/like" -b tmp/cookies.txt
  ```
  ```json
  {"liked":true}
  ```
  > ✅ HTTP 200，点赞成功

  **7. 取消点赞**
  ```bash
  curl -s -X POST "http://localhost:3000/api/comments/<COMMENT_ID>/like" -b tmp/cookies.txt
  ```
  ```json
  {"liked":false}
  ```
  > ✅ HTTP 200，toggle 功能正常

  **8. 获取评论列表（树形结构）**
  ```bash
  curl -s "http://localhost:3000/api/posts/<POST_ID>/comments" -b tmp/cookies.txt
  ```
  ```json
  [
    {
      "id":"<COMMENT_ID>","content":"这是第一条顶级评论","parentId":null,"depth":0,"likeCount":1,
      "authorName":"测试用户","authorImage":null,"isLiked":true,
      "replies":[{"id":"<REPLY_ID>","content":"回复第一条评论","parentId":"<COMMENT_ID>","depth":1,"replies":[]}]
    },
    {"id":"<COMMENT_ID2>","content":"这是第二条顶级评论","parentId":null,"depth":0,"likeCount":0,"replies":[]}
  ]
  ```
  > ✅ HTTP 200，树形结构正确，顶级评论按点赞数倒序，嵌套回复按时间正序

  **9. 删除自己的评论**
  ```bash
  curl -s -X DELETE "http://localhost:3000/api/comments/<COMMENT_ID>" -b tmp/cookies.txt
  ```
  ```json
  {"deleted":true}
  ```
  > ✅ HTTP 200，软删除成功

  **10. 帖主删除他人评论**
  ```bash
  # 帖主删除其他用户的评论
  curl -s -X DELETE "http://localhost:3000/api/comments/<OTHER_USER_COMMENT_ID>" -b tmp/cookies-post-owner.txt
  ```
  ```json
  {"deleted":true}
  ```
  > ✅ HTTP 200，帖主权限正常

  **11. 非作者非帖主删除评论**
  ```bash
  curl -s -X DELETE "http://localhost:3000/api/comments/<COMMENT_ID>" -b tmp/cookies-other-user.txt
  ```
  ```json
  {"code":"FORBIDDEN","message":"无权删除此评论"}
  ```
  > ✅ HTTP 403，权限控制正确

  **12. 未登录发表评论**
  ```bash
  curl -s -X POST "http://localhost:3000/api/posts/<POST_ID>/comments" \
    -H "Content-Type: application/json" \
    -d '{"content":"未登录评论"}'
  ```
  ```json
  {"code":"UNAUTHORIZED","message":"未登录或会话已过期"}
  ```
  > ✅ HTTP 401，正确拦截未登录请求

- **设计详情**：见《技术框架设计》文档 → 第六步

---

## 第七步：用户关注系统

- **状态**：✅ 已完成
- **完成时间**：2026-03-01
- **Git Commit**：`38e3287`
- **Git Commit**：`38e3287`
- **交付物**：
  - FollowsModule（FollowsService）
  - FeedModule（FeedService + FeedController，关注时间流）
  - 用户信息增加关注数/粉丝数/关注状态
  - 数据库 Schema：follow 表
  - 迁移：`drizzle/0003_stiff_sharon_carter.sql`
- **验证记录**：

  **1. 编译验证**
  ```bash
  npm run build
  ```
  > ✅ 编译成功，无错误输出

  **2. 数据库迁移**
  ```bash
  npx drizzle-kit generate
  npx drizzle-kit migrate
  ```
  > ✅ 迁移执行成功，follow 表已创建

  **3. 关注用户**
  ```bash
  curl -s -X POST "http://localhost:3000/api/users/<TARGET_USER_ID>/follow" -b tmp/cookies.txt
  ```
  ```json
  {"following":true}
  ```
  > ✅ HTTP 200，关注成功

  **4. 重复关注（幂等）**
  ```bash
  curl -s -X POST "http://localhost:3000/api/users/<TARGET_USER_ID>/follow" -b tmp/cookies.txt
  ```
  ```json
  {"following":true}
  ```
  > ✅ HTTP 200，幂等处理正确

  **5. 取消关注**
  ```bash
  curl -s -X DELETE "http://localhost:3000/api/users/<TARGET_USER_ID>/follow" -b tmp/cookies.txt
  ```
  ```json
  {"following":false}
  ```
  > ✅ HTTP 200，取消关注成功

  **6. 关注自己**
  ```bash
  curl -s -X POST "http://localhost:3000/api/users/<MY_USER_ID>/follow" -b tmp/cookies.txt
  ```
  ```json
  {"code":"BAD_REQUEST","message":"不能关注自己"}
  ```
  > ✅ HTTP 400，正确拦截

  **7. 用户信息（含关注数/粉丝数）**
  ```bash
  curl -s "http://localhost:3000/api/users/me" -b tmp/cookies.txt
  ```
  ```json
  {"id":"<USER_ID>","name":"测试用户","email":"...","followingCount":1,"followersCount":0}
  ```
  > ✅ HTTP 200，统计数据正确

  **8. 他人信息（含关注状态）**
  ```bash
  curl -s "http://localhost:3000/api/users/<TARGET_USER_ID>" -b tmp/cookies.txt
  ```
  ```json
  {"id":"<TARGET_USER_ID>","name":"第二用户","followingCount":0,"followersCount":1,"isFollowing":true}
  ```
  > ✅ HTTP 200，关注状态正确

  **9. 关注列表**
  ```bash
  curl -s "http://localhost:3000/api/users/<USER_ID>/following" -b tmp/cookies.txt
  ```
  ```json
  [{"id":"<TARGET_USER_ID>","name":"第二用户","image":null,"createdAt":"..."}]
  ```
  > ✅ HTTP 200，返回正确

  **10. 粉丝列表**
  ```bash
  curl -s "http://localhost:3000/api/users/<USER_ID>/followers" -b tmp/cookies.txt
  ```
  ```json
  [{"id":"<FOLLOWER_ID>","name":"测试用户","image":null,"createdAt":"..."}]
  ```
  > ✅ HTTP 200，返回正确

  **11. 关注时间流**
  ```bash
  curl -s "http://localhost:3000/api/feed/following" -b tmp/cookies.txt
  ```
  ```json
  [{"id":"<POST_ID>","userId":"<FOLLOWING_USER_ID>","content":"关注用户的帖子","authorName":"第二用户",...}]
  ```
  > ✅ HTTP 200，仅返回关注用户的帖子

  **12. 未关注任何人时**
  ```bash
  # 用户2未关注任何人，时间流应为空
  curl -s "http://localhost:3000/api/feed/following" -b tmp/cookies-user2.txt
  ```
  ```json
  []
  ```
  > ✅ HTTP 200，返回空数组

- **设计详情**：见《技术框架设计》文档 → 第七步

